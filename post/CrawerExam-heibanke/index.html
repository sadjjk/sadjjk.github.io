<html>
<head>
  <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<title>黑板客爬虫闯关通关 | 金鱼的今语</title>
<link rel="shortcut icon" href="https://sadjjk.github.io/favicon.ico?v=1668343231821">
<link rel="stylesheet" href="https://sadjjk.github.io/styles/main.css" type='text/css' media='all'>
<link href="https://sadjjk.github.io/media/scripts/autoc.css" rel="stylesheet">

<script src="https://sadjjk.github.io/media/scripts/lib/highlight.min.js"></script>
<script src="https://sadjjk.github.io/media/scripts/lib/moment.min.js"></script>
<link href="https://sadjjk.github.io/media/scripts/katex.min.css" rel="stylesheet">



</head>
<body class="home blog ct-body standard">
<div id="overflow-container" class="overflow-container">
  <header id="site-header" class="site-header" role="banner">


    <div class="container">
        <div id="title-info" class="title-info">
            <div id='site-title' class='site-title'>
                <a href="https://sadjjk.github.io">  金鱼的今语 </a>
            </div>
        </div>
        <button id="toggle-navigation" class="toggle-navigation">
            <i class="fa fa-bars"></i>
        </button>
        <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
        <div id="menu-primary" class="menu-container menu-primary" role="navigation">
            <p class="site-description">真话、假话、胡话、全都说</p>
            <div class="menu">
                <ul id="menu-primary-items" class="menu-primary-items">
                     
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="/">首页</a>
                            </li>
                        
                    
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="/archives">归档</a>
                            </li>
                        
                    
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="/tags">标签</a>
                            </li>
                        
                    
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="https://bili.wjinyu.top" target="_blank">B站视频解析</a>
                            </li>
                        
                    
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="https://video.wjinyu.top" target="_blank">今日追剧</a>
                            </li>
                        
                    
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="http://music.wjinyu.top" target="_blank">今语云音乐</a>
                            </li>
                        
                    
                        
                            <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page current-menu-item current_page_item'>
                                <a href="/post/about">关于</a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
    </div>


</header>


  <div id="main" class="main" role="main">
    <div id="loop-container" class="loop-container">
      <div class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">
        
          <div class='featured-image lazy lazy-bg-image' data-background="https://i.loli.net/2019/10/02/jzHqKpdN8tyS6bM.png">
          </div>
        

        <div class="entry-meta">
          <span class="date">· 2019-10-02 ·</span>

          
            <span class="category">
                    <span> / </span>
                    <a href="https://sadjjk.github.io/tag/work/">Work</a>
                </span>
          
        </div>
        <div class='entry-header'>
          <h1 class='entry-title'>黑板客爬虫闯关通关</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article id="article">

            </article>
          </div>
        </div>
          
            <nav class="navigation pagination" role="navigation">
              <h2 class="screen-reader-text">Posts navigation</h2>
              <div class="nav-links">
                <a class="next page-numbers" style="font-size:20px" href="https://sadjjk.github.io/post/DoubanPoster/">下一篇->Python制作豆瓣书单分享海报(仿电影海报)</a>
              </div>
            </nav>
          
      </div>
      <section id="comments" class="comments">
        
      </section>
    </div>
  </div>
  <footer id="site-footer" class="site-footer" role="contentinfo">
    <h1>
        <a href="https://sadjjk.github.io"> 金鱼的今语 </a>
    </h1>
    <p class="site-description" style="font-size:18px">真话、假话、胡话、全都说</p>
    <div id="menu-footer" class="menu-container menu-footer" role="navigation">
        <div class="menu">
            <ul id="menu-footer-items" class="menu-footer-items">
            </ul>
        </div>
    </div>
    <ul class="social-media-icons">
        
            
                <li>
                    <a href="https://github.com/sadjjk" data-animate-hover="pulse" class="github" target="_blank">
                        <i class="fab fa-github" title="github"></i>
                        <span class="screen-reader-text">github</span>
                    </a>
                </li>
            
        
            
        
            
                <li>
                    <a href="https://weibo.com/ " data-animate-hover="pulse" class="weibo" target="_blank">
                        <i class="fab fa-weibo" title="weibo"></i>
                        <span class="screen-reader-text">weibo</span>
                    </a>
                </li>
            
        
            
                <li>
                    <a href="https://www.zhihu.com/" data-animate-hover="pulse" class="zhihu" target="_blank">
                        <i class="fab fa-zhihu" title="zhihu"></i>
                        <span class="screen-reader-text">zhihu</span>
                    </a>
                </li>
            
        
            
        
            
        
            
        
            
        
    </ul>
    <div class="design-credit">
        <p>Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="/atom.xml" target="_blank">RSS</a> | <a href="https://beian.miit.gov.cn" target="_blank">&nbsp;浙ICP备2021037254号-1</a> | <img src="/post-images/gongan.png">浙公网安备 33108202000706号</p>
    </div>
</footer>

<script>
hljs.initHighlightingOnLoad()
</script>
<script src="https://sadjjk.github.io/media/scripts/lib/autoc.min.js"></script>
<script src="https://sadjjk.github.io/media/scripts/lib/jquery.min.js"></script>
<script src="https://sadjjk.github.io/media/scripts/lib/production.min.js"></script>

  <script>
    var article = `<p>爬虫学的好 牢房进的早<br>
Code:https://github.com/sadjjk/CrawerExam-heibanke</p>
<!--more-->
<h3 id="前言">前言</h3>
<p>黑板客爬虫闯关共5关</p>
<ul>
<li>http://www.heibanke.com/lesson/crawler_ex00/</li>
<li>http://www.heibanke.com/lesson/crawler_ex01/</li>
<li>http://www.heibanke.com/lesson/crawler_ex02/</li>
<li>http://www.heibanke.com/lesson/crawler_ex03/</li>
<li>http://www.heibanke.com/lesson/crawler_ex04/</li>
</ul>
<p>网上关于这部分的代码实践也不少<br>
绝知此事要躬行  自己code一遍</p>
<h3 id="第一关">第一关</h3>
<figure data-type="image" tabindex="1"><img src="https://i.loli.net/2019/10/02/hAwDifI4vkNtge9.png" alt="UTOOLS_COMPRESS_1569999755672.png" loading="lazy"></figure>
<p><code>requests</code> GET 不断请求即可</p>
<pre><code>下一个你需要输入的数字是25997. 老实告诉你吧, 这样的数字还有上百个
第49次尝试 URL:http://www.heibanke.com/lesson/crawler_ex00/25997
下一个你需要输入的数字是73222. 老实告诉你吧, 这样的数字还有上百个
第50次尝试 URL:http://www.heibanke.com/lesson/crawler_ex00/73222
下一个你需要输入的数字是93891. 老实告诉你吧, 这样的数字还有上百个
第51次尝试 URL:http://www.heibanke.com/lesson/crawler_ex00/93891
恭喜你,你找到了答案.继续你的爬虫之旅吧
最终地址是：http://www.heibanke.com/lesson/crawler_ex00/93891
END
</code></pre>
<h3 id="第二关">第二关</h3>
<figure data-type="image" tabindex="2"><img src="https://i.loli.net/2019/10/02/Hx8YCN2kVrt9qcJ.png" alt="UTOOLS_COMPRESS_1569999938435.png" loading="lazy"></figure>
<p>猜密码 这里从0~30的列表中 <code>random.choice</code>每次随机给出一个数<br>
若此数密码不正确 则从该列表中remove</p>
<pre><code>尝试密码:13
您输入的密码错误, 请重新输入
尝试密码:5
您输入的密码错误, 请重新输入
尝试密码:10
您输入的密码错误, 请重新输入
尝试密码:8
恭喜! 用户spider成功闯关, 继续你的爬虫之旅吧
</code></pre>
<h3 id="第三关">第三关</h3>
<figure data-type="image" tabindex="3"><img src="https://i.loli.net/2019/10/02/vtEu8UbP31Dgfy7.jpg" alt="Xnip2019-10-02_15-10-41.jpg" loading="lazy"></figure>
<p>第三关先进去是这样的 没有谜题 一头雾水<br>
需要先在这里注册账号 登陆后重新打开 出现谜题</p>
<figure data-type="image" tabindex="4"><img src="https://i.loli.net/2019/10/02/scdnE5CUTq6l4WH.png" alt="UTOOLS_COMPRESS_1570000211937.png" loading="lazy"></figure>
<p>还是猜密码 第一反应就是要先登陆 requests Session 模拟登陆即可<br>
但是没有成功 谜题写着两层保护 也没看懂<br>
百度后 明白了 还有一层token的加密</p>
<figure data-type="image" tabindex="5"><img src="https://i.loli.net/2019/10/02/DmY3XNvFhueLkRJ.png" alt="UTOOLS_COMPRESS_1570000617203.png" loading="lazy"></figure>
<p>首先是账号登陆时需要一个token<br>
其次是谜题猜密码时也需要一个token<br>
这里两个token均来自cookies</p>
<pre><code class="language-python">session = requests.Session()
session.get('http://www.heibanke.com/lesson/crawler_ex02/')
csrftoken1 = session.cookies.get('csrftoken')
account_data = {
    'csrfmiddlewaretoken': csrftoken1,
    'username': 'fikqmw98654',
    'password': '123456'
}
session.post('http://www.heibanke.com/accounts/login/?next=/lesson/crawler_ex02/',
             data = account_data)
csrftoken2 = session.cookies.get('csrftoken')
</code></pre>
<p>两次token不同  需重新获取 然后就是熟悉的猜密码 和第二关相同</p>
<h3 id="第四关">第四关</h3>
<figure data-type="image" tabindex="6"><img src="https://s2.ax1x.com/2019/10/02/uaxydA.png" alt="uaxydA.png" loading="lazy"></figure>
<p>依然一脸懵逼 尝试输入密码 提示密码在这里寻找</p>
<figure data-type="image" tabindex="7"><img src="https://i.loli.net/2019/10/02/LaCRexzIHTGjnom.png" alt="UTOOLS_COMPRESS_1570001394116.png" loading="lazy"></figure>
<p>注意：并不把所有13页的密码按照&lt;位置,值&gt;拼起来就组成最终的密   码，因为有些位置会重复给出 可能加载完所有页 也不一定组成出完整的密码 可能还是会有个别位置缺失<br>
PS:第一次尝试就是把所有页爬下来 拼密码 发现存在个别位置缺失<br>
其实只要第一页反复刷新就可以了<br>
直到所有密码(共100位 页面探索所得)都有拼上为止</p>
<p>当然拼密码之前 需要模拟登陆 熟悉的配方<br>
经过漫长的登陆 终于获得所有位置的密码</p>
<pre><code>共100位密码，已获得99位密码
共100位密码，已获得99位密码
共100位密码，已获得99位密码
共100位密码，已获得100位密码
密码是：5357748950695244329548946136479903948743260484371348776618136963449163264706489936702831052533819016
恭喜! 用户aaa成功闯关, 继续你的爬虫之旅吧
</code></pre>
<h3 id="第五关">第五关</h3>
<figure data-type="image" tabindex="8"><img src="https://i.loli.net/2019/10/02/EIbCJ5zMXGgfvo4.png" alt="UTOOLS_COMPRESS_1570001895588.png" loading="lazy"></figure>
<p>加了验证码 验证码使用OCR识别出正确的字母 这里的图片已经很清晰 不用二值化或灰度处理 唯一的问题就是个别字母倾斜导致OCR识别错误 暂时不知道如何倾斜矫正</p>
<p>OCR使用 pytesseract或者百度OCR  两者的识别准确率半斤八两 都不太高 基本都出错在倾斜字母上 但总体上还是能用</p>
<p>tips:不用把每次的验证码图片下载下来 会下载很多验证码 以后也不会用到 浪费空间  直接获得验证码图片的二进制content 每次拿二进制content去识别</p>
<p>当然验证码识别之前 需要模拟登陆 密码也是30以内的数字 熟悉的配置</p>
<p>经过漫长的等待</p>
<pre><code>第1次尝试,验证码:CINR,密码:3
验证码输入错误
第2次尝试,验证码:SSMO,密码:3
恭喜! 用户spider成功闯关, 后续关卡敬请期待
</code></pre>
<h3 id="end">END</h3>
<p><a href="https://github.com/sadjjk/CrawerExam-heibanke">Code</a>:https://github.com/sadjjk/CrawerExam-heibanke</p>
<p><a href="https://sadjjk.github.io/">Blog</a>    <a href="http://47.105.166.237/index">Stock</a></p>
`
    var content = article.split("<!--more-->")[1]
    if (content != null)
        document.getElementById('article').innerHTML = content;
    else
        document.getElementById('article').innerHTML = article

    let navigation = new AutocJs({
        title:'黑板客爬虫闯关通关',
        isGenerateOutlineChapterCode: false
    })
    </script>
</div>
</body>
</html>

